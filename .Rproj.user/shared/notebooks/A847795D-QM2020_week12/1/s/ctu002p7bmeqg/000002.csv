"0","# Population Size"
"0",""
"0","n <- 100000"
"0",""
"0","# True Parameters"
"0",""
"0","beta0 <- -2"
"0","beta1 <- 0.3"
"0","beta2 <- 0.5"
"0","beta3 <- -0.2"
"0",""
"0","# Independent Variables"
"0",""
"0","X1 <- rnorm(n, 20, 10)"
"0","X2 <- rnorm(n, 1, 0.5)"
"0",""
"0","# Our Systematic component"
"0",""
"0","mu <- beta0 + beta1 * X1 + beta2 * X2 + beta3 * X1 * X2"
"0",""
"0","# Now we generate p via the logit response function"
"0",""
"0","p <- (exp(mu)) / (1 + exp(mu))"
"0",""
"0",""
"0","# As we observe only 0 or 1 we need to put p in a binomial distribution"
"0",""
"0","Y <- rbinom(n, 1, p)"
"0",""
"0","# That's our full population."
"0",""
"0","pop <- data.frame(Y, X1, X2)"
"0",""
"0","# Let's work with a sample from our population"
"0",""
"0","data <- pop[sample(1:10000, 1000),]"
"0",""
"0",""
"0","# Now we can run the model..."
"0",""
"0","m1 <-"
"0","  glm(Y ~ X1 + X2 + X1 * X2,"
"0","      data = data,"
"0","      family = binomial(link = logit))"
"0",""
"0","summary(m1)"
"1","
Call:
"
"1",""
"1","glm(formula = Y ~ X1 + X2 + X1 * X2, family = binomial(link = logit), 
    data = data)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-3.04918  "
"1","-0.74459  "
"1"," 0.06913  "
"1"," 0.72396  "
"1"," 2.42102  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1"," -2.08007"
"1","    0.55740"
"1","  -3.732"
"1","  0.00019"
"1"," ***"
"1","
X1         "
"1","  0.30452"
"1","    0.03328"
"1","   9.151"
"1","  < 2e-16"
"1"," ***"
"1","
X2         "
"1","  0.29589"
"1","    0.48746"
"1","   0.607"
"1","  0.54386"
"1","    "
"1","
X1:X2      "
"1"," -0.19426"
"1","    0.02767"
"1","  -7.020"
"1"," 2.23e-12"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1381.11  on 999  degrees of freedom
"
"1",""
"1","Residual deviance:  902.36  on 996  degrees of freedom
"
"1","AIC: "
"1",""
"1","910.36"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
